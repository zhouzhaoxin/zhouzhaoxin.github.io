---
layout: post
title: "RSA加密过程"
author: zhouzhaoxin
categories: ["后端"]
image: assets/images/rest-4933097_1920.jpg
comments: false
---
## 准备知识
除了1和自身外，没法被其他自然数整除的大于1的整数   
##### 质数
除了1和自身外，没法被其他自然数整除的大于1的整数                   
如：`2，3，5，7，11，13`
##### 互质数
公因数只有1的两个非零自然数，叫做互质数。                               
如 `5，12`
##### 欧拉函数
小于n的正整数中与n互质的数的数目。                                          
如:1到7中，与8互质的整数为`1，3，5，7`，所以`φ(8)=4`

性质：
1. 给定一个正整数`m`，如果两个整数`a`和`b`满足`a-b`能够被`m`整除，即`(a-b)/m`得到一个整数，那么就称整数`a`与`b`对模m同余，记作`a≡b(mod m)`  <br>如：`3≡5 （mod 2)`
2. 若`n`为质数则 `φ(n)=n-1`(注：`n`为质数，`n`的因数只有`1`和`n`,前`n-1`个数与`n`的公因数只有`1`，所以` φ(n)=n-1` 即`1，2，3，...，n-1`)
3. 若`m`,`n`互质，` φ(m * n)=φ(m) * φ(n) `(当`m`,`n`都为质数时，`φ(m*n)=φ(m) * φ(n) = (m-1) * (n-1)`  ,因为`m`, `n `为质数，所以`m*n`只与`m`或`n`的倍数不是互质数，一共有`m * n -1 `个数， `m`的倍数有`n-1`个， `n`的倍数`m-1`个，所以`φ(m * n)=(m * n-1) - (m-1) - (n-1)=(m-1) * (n-1)`）
4. 若`m`,`n` 互质，则  ` m ** φ(n) ≡ 1 (mod n)`
    4.1 模反元素：若`m,n` 互质，一定存在一个整数`a`, 使得：`m * a ≡ 1 (mod n)`。称`a`为`m`对于`n`的模反元素

## RSA生成过程
1. 随机选择两个极大的不相等质数`p`, `q`；                                                                                                                                                                                                     
 1.1 为方便计算取`p = 13`,` q = 17`

2. 计算`p`与`q`的乘积`n`；                                                                                                                                                                                                                                         
 2.1 `n = 13  *  17 = 221`

3. 计算`n`的欧拉函数`φ(n)`；                                                                                                                                                                                                                               
 3.1  `φ(n) = （13 - 1） * （17 - 1） = 192`

4. 随机选择一个整数`e`，`1<e<φ(n)`且`e`与`φ(n)`互质；                                                                                                                                                                                              
 4.1 例如取`e = 5`

5. 计算`e`对于`φ(n)`的模反元素`d`，` ed ≡ 1 (mod φ(n))  e * d = k * φ(n) + 1   d = (k * φ(n) + 1)/e ` 取`k=0,1,2...`计算`d`的数值，直到`d`为整数
 5.1 求得` d = 77`，此时`k=2`

6. 将`n`和`e`封装为公钥， `n`和`d`封装为私钥;                                                                                                                                                                                                     
 6.1 即以上步骤生成的公钥为` 221，5 `   私钥为` 221，77`

## 加密过程
1. 有待加密信息`m`(`m`必须为整数，字符串取`ascii`值或`unicode`值, 且`m < n`)；                                                                                                                                                           
 1.1 例如取`m = 10`

2. 根据加密公式`m ** e ≡ c (mod n)` ，使用公钥加密,生成密文 `c`;                                                                                                                                                                                                  
 2.1 `10 ** 5 % 221 = 108`  即`c = 108`

3.根据解密公式 `c ** d ≡ m (mod n) `  使用私钥解密,生成明文 `m`为;                                                                                                                                                                                                 
 3.1 `108 ** 77 % 221 = 10` 即`m = 10`

## RSA加密安全性探讨：
1. 基于已知的公钥，是否能计算出私钥：即已知`n`,`e` 求 `d`
2. 因为 `d = (k * φ(n) + 1)/e`， 所以只需计算出`n`的欧拉函数值`φ(n)`, 已知`n`是两个质数`p`、`q`的乘积 `φ(n) = φ(p * q) = φ(p) * φ(q) = (p-1) * (q-1)`
3. `RSA`加密安全强度就是在于`n`的因数分解的难度，`n`越大越安全，目前`n`为1024或2048位，普通计算机无法对其进行因式分解